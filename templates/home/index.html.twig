{# templates/home/index.html.twig #}
{% extends 'base.html.twig' %}
{% block title %}Accueil{% endblock %}

{% block extra_styles %}
  {{ parent() }}
  <link rel="stylesheet" href="{{ asset('styles/home.css') }}">
{% endblock %}

{% block body %}
<div class="container py-4">

  {# Bloc "hero" avec message boutique #}
  <div class="p-4 p-md-5 mb-4 bg-body-tertiary rounded-3">
    <div class="container-fluid py-1">
      <h1 class="h3 mb-1">{{ 'home.featured_title'|trans }}</h1>
      <p class="text-secondary mb-1">{{ 'home.featured_subtitle'|trans }}</p>
      {# Ajoute home.store_message dans tes YAML si tu veux le traduire #}
      <p class="text-secondary mb-3">
        {{ 'home.store_message'|trans }}
       
      </p>
      <a class="btn btn-primary" href="{{ path('app_products') }}">{{ 'home.see_all'|trans }}</a>
    </div>
  </div>

  {# Grille de 3 produits "featured" #}
  {% if featured is empty %}
    <div class="alert alert-info">{{ 'home.no_featured'|trans }}</div>
  {% else %}
    <div class="row g-3">
      {% for p in featured|slice(0,3) %}
        <div class="col-12 col-sm-6 col-lg-4">
          <div class="card h-100 shadow-sm">

            <a href="{{ path('app_product_show', { id: p.id }) }}" class="text-decoration-none text-reset">
              {% set imageSrc = p.imageUrl
                ? asset('images/products/' ~ p.imageUrl)
                : asset('images/placeholder.png') %}
              <img
                src="{{ imageSrc }}"
                class="card-img-top product-img"
                alt="{{ p.name }}"
                loading="lazy"
              >
            </a>

            <div class="card-body d-flex flex-column">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <h3 class="card-title h5 m-0">{{ p.name }}</h3>
                {% if p.featured %}
                  <span class="badge text-bg-primary">{{ 'products.badge.featured'|trans }}</span>
                {% endif %}
              </div>

              <p class="fw-semibold mb-3">
                {{ (p.priceEuro is defined ? p.priceEuro : p.price / 100)|number_format(2, ',', ' ') }} â‚¬
              </p>

              <div class="mt-auto d-grid gap-2">
                <form action="{{ path('app_panier_add', { id: p.id }) }}" method="post" class="m-0">
                  <input type="hidden" name="_token" value="{{ csrf_token('add_to_cart' ~ p.id) }}">
                  <input type="hidden" name="qty" value="1">
                  <button type="submit" class="btn btn-primary">{{ 'product.add_to_cart'|trans }}</button>
                </form>

                <a href="{{ path('app_product_show', { id: p.id }) }}" class="btn btn-outline-secondary">
                  {{ 'products.details'|trans }}
                </a>
              </div>
            </div>

          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}

</div>
{% endblock %}


